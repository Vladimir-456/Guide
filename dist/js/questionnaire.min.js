import{initValidate as e}from"./validate.js";import{lockScroll as t,unlockScroll as o}from"./utils.js";const r=document.querySelector(".profile-modal__overlay"),n=document.querySelector(".profile-modal__close"),a=document.querySelector("#profile-modal__form"),i=document.querySelector(".button--anketa"),c=()=>{r.style.display="block",t(),n.addEventListener("click",s)},l=async t=>{t.preventDefault();const o=e();if(!o)return;if(!await o.revalidate())return;const r=new FormData(t.target),n=Object.fromEntries(r);try{const e=await fetch("/api/application",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Network response was not ok");await e.json();s(),window.location.href="/manage",a.reset()}catch(e){}};function s(){r.style.display="none",o(),a.reset(),n.removeEventListener("click",s)}export const initProfileModal=()=>{i.addEventListener("click",c),a.addEventListener("submit",l)};