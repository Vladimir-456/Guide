import{initValidateCallback as e}from"./validate.js";const t=document.querySelector(".modal__close"),o=document.querySelector(".modal__overlay"),r=document.querySelectorAll(".button__slider"),n=document.querySelector(".modal__form");function a(){o.style.display="block",t.addEventListener("click",c)}function c(){o.style.display="none",n.reset(),t.removeEventListener("click",c)}const l=async t=>{t.preventDefault();const o=e();if(await o.revalidate())try{const e=(e=>{const t={};return e.forEach(((e,o)=>{t[o]="agreement"===o||"newsletter"===o?"on"===e||"true"===e:e})),t})(new FormData(t.target)),o=await fetch("/api/callback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!o.ok)throw new Error("Network response was not ok");await o.json();c(),n.reset(),alert("Спасибо! Ваша заявка принята.")}catch(e){alert("Произошла ошибка при отправке формы. Пожалуйста, попробуйте позже.")}};export const initModal=()=>{o&&t&&n&&(r.forEach((e=>{e.addEventListener("click",a)})),n.addEventListener("submit",l))};