import{initValidateCallback as e}from"./validate.js";const t=document.querySelector(".modal__close"),o=document.querySelector(".modal__overlay"),n=document.querySelectorAll(".button__slider"),r=document.querySelector(".modal__form");function a(){o.style.display="block",t.addEventListener("click",c)}function c(){o.style.display="none",r.reset(),t.removeEventListener("click",c)}const i=async t=>{t.preventDefault();const o=e();if(await o.revalidate())try{const e=(e=>{const t={};return e.forEach(((e,o)=>{t[o]="agreement"===o||"newsletter"===o?"on"===e||"true"===e:e})),t})(new FormData(t.target)),o=await fetch("/api/callback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!o.ok)throw new Error("Network response was not ok");await o.json();c(),r.reset(),window.location.href="/manage"}catch(e){alert("Произошла ошибка при отправке формы. Пожалуйста, попробуйте позже.")}};export const initModal=()=>{n.forEach((e=>{e.addEventListener("click",a)})),r.addEventListener("submit",i)};